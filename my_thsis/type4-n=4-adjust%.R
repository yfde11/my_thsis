#Type4 adjust persentage
#type4 - n=4 
library (lpSolve)

R = 1
LB = 1-R
UB = 1+R

f.obj <- c (0,0,0,0, 0.001, 0.001, 0.001, 0.001,    0.001, 0.001,0.001, 0.001,   1,1,1,1, 1,1,1,1)

f.con <- matrix ( c ( 
  1,1,1,1, 0,0,0,0, 0,0,0,0,  0,0,0,0,0,0,0,0,   #row xi
  
  1,-1,0,0, 1,0,0,0, -1,0,0,0, 0,0,0,0,0,0,0,0,   #row1
  0,1,-1,0, 0,1,0,0, 0,-1,0,0, 0,0,0,0,0,0,0,0,   #row2
  0,0,1,-1, 0,0,1,0, 0,0,-1,0, 0,0,0,0,0,0,0,0,   #row3
  -1,0,0,1, 0,0,0,1, 0,0,0,-1, 0,0,0,0,0,0,0,0,   #row4
  
  1,0,0,0, 0,0,0,0,  0,0,0,0, 1,0,0,0,0,0,0,0,   #row1
  0,1,0,0, 0,0,0,0,  0,0,0,0, 0,1,0,0,0,0,0,0,   #row2
  0,0,1,0, 0,0,0,0,  0,0,0,0, 0,0,1,0,0,0,0,0,   #row3
  0,0,0,1, 0,0,0,0,  0,0,0,0, 0,0,0,1,0,0,0,0,   #row4
  
  -1,0,0,0, 0,0,0,0,  0,0,0,0, 0,0,0,0,-1,0,0,0,   #row5
  0,-1,0,0, 0,0,0,0,  0,0,0,0, 0,0,0,0,0,-1,0,0,   #row6
  0,0,-1,0, 0,0,0,0,  0,0,0,0, 0,0,0,0,0,0,-1,0,   #row7
  0,0,0,-1, 0,0,0,0,  0,0,0,0, 0,0,0,0,0,0,0,-1    #row8
  
), nrow = 13 , byrow = TRUE )

f.dir <- c ("=" , "=" , "=" , "=" , "=", ">=", ">=",">=",">=",">=",">=",">=",">=")
#f.rhs <- c (1 ,0,0,0,0, 0.38,0.285,0.19, 0.095,-0.42,-0.315,-0.21,-0.105)
f.rhs <- c (1 ,0,0,0,0, (0.4*LB),(0.3*LB),(0.2*LB), (0.1*LB),-(0.4*UB),-(0.3*UB),-(0.2*UB),-(0.1*UB))
lp.result <- lp ( "min" , f.obj, f.con, f.dir, f.rhs) 

x1 <- lp.result$solution[[1]]*10000
x2 <- lp.result$solution[[2]]*10000
x3 <- lp.result$solution[[3]]*10000
x4 <- lp.result$solution[[4]]*10000

SE <- (x1-4000)^2 +(x2-3000)^2 +(x3-2000)^2 +(x4-1000)^2 
MSE <- SE/4
RMSE <- MSE^0.5

A <- 2500
B <- 2500
C <- 2500
D <- 2500

OSE <- (A-4000)^2 +(B-3000)^2 +(C-2000)^2 +(D-1000)^2 
OMSE <- OSE/4
ORMSE <- OMSE^0.5

GP <- (RMSE-ORMSE)/(0-ORMSE)
GP