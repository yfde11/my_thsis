#t0 = wi=wj
#typeM - n=4 
library (lpSolve)

f.obj <- c (0,0,0,0, #Wi
            #0.001, 0.001, 0.001, 0.001,    0.001, 0.001,0.001, 0.001,#f
            1,1,1, 1,1,1,#e1
            1,1,1, 1,1,1,#e2
            1,1,1, 1,#e3
            1,1,1,1,1, 1,1,1,#e4
            1,1,1, 1,1,1)#e5

f.con <- matrix ( c ( 
  1,1,1,1,  0,0,0,0,0,0,  0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row xi
  
  #T1  
  1,-1,0,0, 1,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row1
  1,0,-1,0, 0,1,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row2
  1,0,0,-1, 0,0,1,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row3
  0,1,-1,0, 0,0,0,1,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row4
  0,1,0,-1, 0,0,0,0,1,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row5
  0,0,1,-1, 0,0,0,0,0,1, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row6
  #T2
  1,-1,0,0, 0,0,0,0,0,0, 1,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row1
  1,0,-1,0, 0,0,0,0,0,0, 0,1,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row2
  1,0,0,-1, 0,0,0,0,0,0, 0,0,1,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row3
  0,1,-1,0, 0,0,0,0,0,0, 0,0,0,1,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row4
  0,1,0,-1, 0,0,0,0,0,0, 0,0,0,0,1,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row5
  0,0,1,-1, 0,0,0,0,0,0, 0,0,0,0,0,1,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row6
  #T3
  1,-2,1,0, 0,0,0,0,0,0, 0,0,0,0,0,0,  1,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row1
  1,-2,0,1, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,1,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row2
  1,0,-2,1, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,1,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row3
  0,1,-2,1, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,1,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,     #row4
  #T4
  1,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,1,0, 0,0,0,0,0,0, 0,0,0,0,0,0,      #row1
  0,1,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,1, 0,0,0,0,0,0, 0,0,0,0,0,0,      #row2
  0,0,1,0, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 1,0,0,0,0,0, 0,0,0,0,0,0,      #row3
  0,0,0,1, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,1,0,0,0,0, 0,0,0,0,0,0,      #row4
  
  -1,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,-1,0,0,0, 0,0,0,0,0,0,    #row5
  0,-1,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,-1,0,0, 0,0,0,0,0,0,    #row6
  0,0,-1,0, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,-1,0, 0,0,0,0,0,0,    #row7
  0,0,0,-1, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,-1, 0,0,0,0,0,0,    #row8
  #T5
  1,-(4/3),0,0, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 1,0,0,0,0,0, #row1
  1,0,-(4/2),0, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,1,0,0,0,0, #row2
  1,0,0,-(4/1), 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,1,0,0,0, #row3
  0,1,-(3/2),0, 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,1,0,0, #row4
  0,1,0,-(3/1), 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,1,0, #row5
  0,0,1,-(2/1), 0,0,0,0,0,0, 0,0,0,0,0,0,  0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,1  #row6
  
), nrow = 31 , byrow = TRUE )

f.dir <- c ("=" , #T0
            ">=", ">=",">=",">=",">=",">=",#T1
            ">=", ">=",">=",">=",">=",">=",#T2
            ">=", ">=",">=",">=",#T3
            ">=",">=", ">=", ">=",">=",">=",">=",">=",#T4
            ">=", ">=",">=",">=",">=",">=")#T5
f.rhs <- c (1 ,#T0
            0,0,0, 0,0,0,#T1
            0.1,0.2,0.3, 0.1,0.2,0.1,#T2
            0,0,0,0,#T3
            0.38,0.285,0.19, 0.095,-0.42,-0.315,-0.21,-0.105,#T4
            0,0,0, 0,0,0)#T5
lp.result <- lp ( "min" , f.obj, f.con, f.dir, f.rhs) 


lp.result$solution[[1]]
lp.result$solution[[2]]
lp.result$solution[[3]]
lp.result$solution[[4]]
